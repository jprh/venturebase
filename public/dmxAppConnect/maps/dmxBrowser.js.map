{"version":3,"sources":["components/browser.js"],"names":["dmx","Component","initialData","online","navigator","onLine","userAgent","language","cookieEnabled","referrer","document","location","hash","host","hostname","href","origin","pathname","port","protocol","search","pathparts","slice","split","scrollX","offset","direction","position","scrollY","viewport","width","height","device","pixelRatio","orientation","hidden","visibility","visibilityState","methods","goto","url","internal","title","routing","router","history","pushState","window","dispatchEvent","Event","assign","reload","back","forward","scrollTo","x","y","scrollXTo","left","behavior","scrollYTo","top","scrollBy","scrollXBy","scrollYBy","alert","message","print","writeTextToClipboard","text","clipboard","writeText","events","scroll","resize","offline","popstate","pushstate","replacestate","visibilitychange","orientationchange","init","node","this","_loadHandler","bind","_sizeHandler","throttle","_onlineHandler","_locationHandler","_visibilityHandler","_languageHandler","_orientationHandler","addEventListener","nextTick","_updateSize","destroy","removeEventListener","doc","_documentSize","innerWidth","innerHeight","data","set","length","Math","max","screenY","screen","devicePixelRatio","_orientation","_updateLocation","body","scrollWidth","documentElement","offsetWidth","clientWidth","scrollHeight","offsetHeight","clientHeight","matchMedia","matches","event","type"],"mappings":"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","file":"../dmxBrowser/dmxBrowser.js","sourcesContent":["dmx.Component('browser', {\r\n\r\n  initialData: {\r\n    online: navigator.onLine,\r\n    userAgent: navigator.userAgent,\r\n    language: navigator.language,\r\n    cookieEnabled: navigator.cookieEnabled,\r\n    referrer: document.referrer,\r\n\r\n    location: {\r\n      hash: location.hash,\r\n      host: location.host,\r\n      hostname: location.hostname,\r\n      href: location.href,\r\n      origin: location.origin,\r\n      pathname: location.pathname,\r\n      port: location.port,\r\n      protocol: location.protocol,\r\n      search: location.search,\r\n      pathparts: location.pathname.slice(1).split('/'),\r\n    },\r\n\r\n    scrollX: {\r\n      offset: 0,\r\n      direction: 0,\r\n      position: 0,\r\n    },\r\n\r\n    scrollY: {\r\n      offset: 0,\r\n      direction: 0,\r\n      position: 0,\r\n    },\r\n\r\n    viewport: {\r\n      width: 0,\r\n      height: 0,\r\n    },\r\n\r\n    device: {\r\n      width: 0,\r\n      height: 0,\r\n      pixelRatio: 1,\r\n      orientation: 'landscape',\r\n    },\r\n\r\n    document: {\r\n      width: 0,\r\n      height: 0,\r\n      hidden: document.hidden,\r\n      visibility: document.visibilityState,\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    goto (url, internal, title) {\r\n      if (internal) {\r\n        if (dmx.routing && dmx.routing.router == 'hash') {\r\n          url = '#!' + url;\r\n        }\r\n  \r\n        history.pushState({ title: title || document.title }, '', url);\r\n        if (title) document.title = title;\r\n        window.dispatchEvent(new Event('pushstate'));\r\n      } else {\r\n        location.assign(url);\r\n      }\r\n    },\r\n\r\n    reload () {\r\n      location.reload();\r\n    },\r\n\r\n    back () {\r\n      history.back();\r\n    },\r\n\r\n    forward () {\r\n      history.forward();\r\n    },\r\n\r\n    scrollTo (x, y) {\r\n      window.scrollTo(x, y);\r\n    },\r\n\r\n    scrollXTo (left, behavior) {\r\n      window.scrollTo({ left, behavior });\r\n    },\r\n\r\n    scrollYTo (top, behavior) {\r\n      window.scrollTo({ top, behavior });\r\n    },\r\n\r\n    scrollBy (x, y) {\r\n      window.scrollBy(x, y);\r\n    },\r\n\r\n    scrollXBy (left, behavior) {\r\n      window.scrollBy({ left, behavior });\r\n    },\r\n\r\n    scrollYBy (top, behavior) {\r\n      window.scrollBy({ top, behavior });\r\n    },\r\n\r\n    alert (message) {\r\n      window.alert(message);\r\n    },\r\n\r\n    print () {\r\n      window.print();\r\n    },\r\n\r\n    writeTextToClipboard (text) {\r\n      return navigator.clipboard.writeText(text);\r\n    },\r\n  },\r\n\r\n  events: {\r\n    scroll: Event,\r\n    resize: Event,\r\n    online: Event,\r\n    offline: Event,\r\n    popstate: Event,\r\n    pushstate: Event,\r\n    replacestate: Event,\r\n    visibilitychange: Event,\r\n    orientationchange: Event,\r\n  },\r\n\r\n  init (node) {\r\n    this._loadHandler = this._loadHandler.bind(this);\r\n    this._sizeHandler = dmx.throttle(this._sizeHandler.bind(this));\r\n    this._onlineHandler = this._onlineHandler.bind(this);\r\n    this._locationHandler = this._locationHandler.bind(this);\r\n    this._visibilityHandler = this._visibilityHandler.bind(this);\r\n    this._languageHandler = this._languageHandler.bind(this);\r\n    this._orientationHandler = this._orientationHandler.bind(this);\r\n\r\n    window.addEventListener('load', this._loadHandler);\r\n    window.addEventListener('scroll', this._sizeHandler);\r\n    window.addEventListener('resize', this._sizeHandler);\r\n    window.addEventListener('online', this._onlineHandler);\r\n    window.addEventListener('offline', this._onlineHandler);\r\n    window.addEventListener('popstate', this._locationHandler);\r\n    window.addEventListener('pushstate', this._locationHandler);\r\n    window.addEventListener('replacestate', this._locationHandler);\r\n    window.addEventListener('hashchange', this._locationHandler);\r\n    window.addEventListener('languagechange', this._languageHandler);\r\n    window.addEventListener('deviceorientation', this._orientationHandler);\r\n    document.addEventListener('visibilitychange', this._visibilityHandler);\r\n\r\n    dmx.nextTick(() => this._updateSize());\r\n  },\r\n\r\n  destroy () {\r\n    window.removeEventListener('load', this._loadHandler);\r\n    window.removeEventListener('scroll', this._sizeHandler);\r\n    window.removeEventListener('resize', this._sizeHandler);\r\n    window.removeEventListener('online', this._onlineHandler);\r\n    window.removeEventListener('offline', this._onlineHandler);\r\n    window.removeEventListener('popstate', this._locationHandler);\r\n    window.removeEventListener('pushstate', this._locationHandler);\r\n    window.removeEventListener('replacestate', this._locationHandler);\r\n    window.removeEventListener('hashchange', this._locationHandler);\r\n    window.removeEventListener('languagechange', this._languageHandler);\r\n    window.removeEventListener('deviceorientation', this._orientationHandler);\r\n    document.removeEventListener('visibilitychange', this._visibilityHandler);\r\n  },\r\n\r\n  _updateSize () {\r\n    const doc = this._documentSize();\r\n    const width = doc.width - window.innerWidth;\r\n    const height = doc.height - window.innerHeight;\r\n\r\n    let direction = { x: this.data.scrollX.direction, y: this.data.scrollY.direction };\r\n\r\n    if (this.data.scrollX.offset < window.scrollX) {\r\n      direction.x = 1;\r\n    } else if (this.data.scrollX.offset > window.scrollX) {\r\n      direction.x = -1;\r\n    }\r\n\r\n    if (this.data.scrollY.offset < window.scrollY) {\r\n      direction.x = 1;\r\n    } else if (this.data.scrollY.offset > window.scrollY) {\r\n      direction.x = -1;\r\n    }\r\n\r\n    this.set({\r\n      scrollX: {\r\n        offset: window.scrollX,\r\n        length: Math.max(0, width),\r\n        direction: direction.x,\r\n        position: window.scrollX > 0 ? window.scrollX / width : 0,\r\n      },\r\n      scrollY: {\r\n        offset: window.scrollY,\r\n        length: Math.max(0, height),\r\n        direction: direction.x,\r\n        position: window.scrollY > 0 ? window.scrollY / height : 0,\r\n      },\r\n      viewport: {\r\n        width: window.innerWidth,\r\n        height: window.innerHeight,\r\n        scrollX: window.scrollX,\r\n        scrollY: window.screenY,\r\n      },\r\n      device: {\r\n        width: window.screen.width,\r\n        height: window.screen.height,\r\n        pixelRatio: window.devicePixelRatio,\r\n        orientation: this._orientation(),\r\n      },\r\n      document: {\r\n        width: doc.width,\r\n        height: doc.height,\r\n        hidden: document.hidden,\r\n        visibility: document.visibilityState,\r\n      }\r\n    });\r\n  },\r\n\r\n  _updateLocation () {\r\n    this.set('location', {\r\n      hash: location.hash,\r\n      host: location.host,\r\n      hostname: location.hostname,\r\n      href: location.href,\r\n      origin: location.origin,\r\n      pathname: location.pathname,\r\n      port: location.port,\r\n      protocol: location.protocol,\r\n      search: location.search,\r\n      pathparts: location.pathname.slice(1).split('/')\r\n    });\r\n  },\r\n  \r\n  _documentSize () {\r\n    return {\r\n      width: Math.max(\r\n        document.body.scrollWidth, document.documentElement.scrollWidth,\r\n        document.body.offsetWidth, document.documentElement.offsetWidth,\r\n        document.body.clientWidth, document.documentElement.clientWidth\r\n      ),\r\n      height: Math.max(\r\n        document.body.scrollHeight, document.documentElement.scrollHeight,\r\n        document.body.offsetHeight, document.documentElement.offsetHeight,\r\n        document.body.clientHeight, document.documentElement.clientHeight\r\n      ),\r\n    };\r\n  },\r\n\r\n  _orientation () {\r\n    return window.matchMedia('(orientation: portrait)').matches ? 'portrait' : 'landscape';\r\n  },\r\n\r\n  _loadHandler (event) {\r\n    this._updateSize();\r\n  },\r\n\r\n  _sizeHandler (event) {\r\n    this._updateSize();\r\n    this.dispatchEvent(event.type);\r\n  },\r\n\r\n  _onlineHandler (event) {\r\n    this.set('online', event.type === 'online');\r\n    this.dispatchEvent(event.type);\r\n  },\r\n\r\n  _locationHandler (event) {\r\n    this._updateLocation();\r\n    this.dispatchEvent(event.type);\r\n  },\r\n\r\n  _languageHandler (event) {\r\n    this.set('language', navigator.language);\r\n  },\r\n\r\n  _orientationHandler (event) {\r\n    this._updateSize();\r\n    this.dispatchEvent('orientationchange');\r\n  },\r\n\r\n  _visibilityHandler (event) {\r\n    const doc = this._documentSize();\r\n\r\n    this.set('document', {\r\n      width: doc.width,\r\n      height: doc.height,\r\n      hidden: document.hidden,\r\n      visibility: document.visibilityState,\r\n    });\r\n\r\n    this.dispatchEvent(event.type);\r\n  },\r\n\r\n});\r\n"]}