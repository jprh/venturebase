{"version":3,"sources":["components/autocomplete.js"],"names":["dmx","Component","extends","initialData","selectedItem","attributes","data","type","Array","default","matchcase","Boolean","matchstart","matchaccent","optiontext","String","optionvalue","optionsearch","noresultslabel","placeholder","noclear","events","noresults","Event","render","node","BaseComponent","prototype","call","this","dataItems","props","value","updateValue","$node","disabled","setAttribute","input","cloneNode","removeAttribute","addEventListener","onBlur","bind","onInput","onKeydown","list","document","createElement","style","display","updateData","parentNode","insertBefore","form","onReset","update","equal","repeatItems","map","item","index","label","parse","DataScope","search","updated","setValue","event","find","set","isDefault","defaultValue","focus","disable","valid","i","length","dispatchEvent","closeList","currentFocus","innerHTML","forEach","matches","div","getItemHtml","preventDefault","stopPropagation","appendChild","children","textContent","showList","keyCode","updateActive","divs","getElementsByTagName","MouseEvent","normalize","toLowerCase","substring","indexOf","html","htmlEncode","matcher","RegExp","escapeRegExp","replace","m","str","result","split","c","charCodeAt","fromCharCode","join","classList","remove","add","left","offsetLeft","top","offsetTop","offsetHeight","nextSibling","removeChild"],"mappings":"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","file":"../dmxAutocomplete/dmxAutocomplete.js","sourcesContent":["dmx.Component('autocomplete', {\r\n\r\n    extends: 'input',\r\n\r\n    initialData: {\r\n        selectedItem: null\r\n    },\r\n\r\n    attributes: {\r\n        data: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n\r\n        matchcase: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n\r\n        matchstart: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n\r\n        matchaccent: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n\r\n        optiontext: {\r\n            type: String,\r\n            default: '$value'\r\n        },\r\n\r\n        optionvalue: {\r\n            type: String,\r\n            default: '$value'\r\n        },\r\n\r\n        optionsearch: {\r\n            type: String,\r\n            default: null\r\n        },\r\n\r\n        noresultslabel: {\r\n            type: String,\r\n            default: 'No Results...'\r\n        },\r\n\r\n        placeholder: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n\r\n        noclear: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n\r\n    events: {\r\n        noresults: Event\r\n    },\r\n\r\n    render: function(node) {\r\n        dmx.BaseComponent.prototype.render.call(this, node);\r\n\r\n        this.dataItems = [];\r\n\r\n        if (!this.props.value) {\r\n            this.props.value = this.$node.value;\r\n        } else {\r\n            this.updateValue = true;\r\n        }\r\n\r\n        this.$node.disabled = this.props.disabled;\r\n        this.$node.setAttribute('placeholder', this.props.placeholder);\r\n\r\n        this.input = this.$node.cloneNode();\r\n        this.input.removeAttribute('id');\r\n        this.input.removeAttribute('name');\r\n        this.input.setAttribute('placeholder', this.props.placeholder);\r\n        this.input.setAttribute('autocomplete', 'off');\r\n        this.input.setAttribute('form', 'dummy'); // form should ignore this input\r\n        this.input.addEventListener('blur', this.onBlur.bind(this));\r\n        this.input.addEventListener('input', this.onInput.bind(this));\r\n        this.input.addEventListener('keydown', this.onKeydown.bind(this));\r\n\r\n        this.list = document.createElement('div');\r\n        this.list.setAttribute('class', 'dmx-autocomplete-items');\r\n\r\n        this.$node.style.display = 'none';\r\n        this.$node.addEventListener('change', this.updateData.bind(this));\r\n        this.$node.addEventListener('invalid', this.updateData.bind(this));\r\n\r\n        this.$node.parentNode.insertBefore(this.input, this.$node);\r\n\r\n        if (this.$node.form) {\r\n            this.$node.form.addEventListener('reset', this.onReset.bind(this));\r\n        }\r\n    },\r\n\r\n    update: function(props) {\r\n        if (!dmx.equal(this.props.data, props.data) || this.props.optiontext != props.optiontext || this.props.optionvalue != props.optionvalue) {\r\n            this.dataItems = dmx.repeatItems(this.props.data).map(function(item, index) {\r\n                const label = dmx.parse(this.props.optiontext, dmx.DataScope(item, this));\r\n                const value = dmx.parse(this.props.optionvalue, dmx.DataScope(item, this));\r\n                const search = this.props.optionsearch ? dmx.parse(this.props.optionsearch, dmx.DataScope(item, this)) : label;\r\n                return { index, label, value, search, item };\r\n            }, this);\r\n\r\n            this.updateValue = true;\r\n        }\r\n\r\n        if (this.props.value != props.value) {\r\n            this.updateValue = true;\r\n        }\r\n\r\n        if (this.props.disabled != props.disabled) {\r\n            this.$node.disabled = this.props.disabled;\r\n            this.input.disabled = this.props.disabled;\r\n        }\r\n\r\n        if (this.props.placeholder != props.placeholder) {\r\n            this.input.setAttribute('placeholder', this.props.placeholder);\r\n        }\r\n\r\n        this.updateData();\r\n    },\r\n\r\n    updated: function() {\r\n        if (this.updateValue) {\r\n            this.updateValue = false;\r\n            this.setValue(this.props.value, true);\r\n            this.updateData();\r\n        }\r\n    },\r\n\r\n    updateData: function(event) {\r\n        dmx.Component('form-element').prototype.updateData.call(this, event);\r\n        var selectedItem = this.dataItems.find(function(item) {\r\n            return item.value == this.$node.value;\r\n        }, this);\r\n        this.set('selectedItem', selectedItem ? selectedItem.item : null);\r\n    },\r\n\r\n    setValue: function(value, isDefault) {\r\n        var selectedItem = this.dataItems.find(function(item) {\r\n            return item.value == value;\r\n        }, this);\r\n\r\n        this.$node.value = selectedItem ? selectedItem.value : '';\r\n        this.input.value = selectedItem ? selectedItem.label : '';\r\n\r\n        if (isDefault) {\r\n            this.$node.defaultValue = selectedItem ? selectedItem.value : '';\r\n            this.input.defaultValue = selectedItem ? selectedItem.label : '';\r\n        }\r\n    },\r\n\r\n    focus: function() {\r\n        this.input.focus();\r\n    },\r\n\r\n    disable: function(disable) {\r\n        this.$node.disabled = (disable === true);\r\n        this.input.disabled = (disable === true);\r\n        this.updateData();\r\n    },\r\n\r\n    onReset: function(event) {\r\n        this.$node.value = this.$node.defaultValue;\r\n        this.input.value = this.input.defaultValue;\r\n    },\r\n\r\n    onBlur: function(event) {\r\n        var valid = false;\r\n\r\n        if (this.dataItems) {\r\n            for (var i = 0; i < this.dataItems.length; i++) {\r\n                if (this.dataItems[i].label == this.input.value) {\r\n                    this.$node.value = this.dataItems[i].value;\r\n                    valid = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!valid) {\r\n            if (this.props.noclear) {\r\n                this.$node.value = this.input.value;\r\n            } else {\r\n                this.input.value = '';\r\n                this.$node.value = '';\r\n            }\r\n        }\r\n\r\n        this.$node.dispatchEvent(new Event('change'));\r\n\r\n        this.closeList();\r\n    },\r\n\r\n    onInput: function(event) {\r\n        var $node = this.$node;\r\n        var input = this.input;\r\n        var value = input.value;\r\n\r\n        this.closeList();\r\n\r\n        if (!value) return;\r\n\r\n        this.currentFocus = -1;\r\n        this.list.innerHTML = '';\r\n\r\n        this.dataItems.forEach(function(item) {\r\n            if (this.matches(item.search, value)) {\r\n                var div = document.createElement('div');\r\n                div.setAttribute('class', 'dmx-autocomplete-item');\r\n                div.innerHTML = this.getItemHtml(item.label, value);\r\n                div.item = item;\r\n\r\n                div.addEventListener('mousedown', (event) => {\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    $node.value = item.value;\r\n                    input.value = item.label;\r\n                    this.closeList();\r\n                    $node.dispatchEvent(new Event('change'));\r\n                });\r\n\r\n                this.list.appendChild(div);\r\n            }\r\n        }, this);\r\n\r\n        if (!this.list.children.length) {\r\n            var div = document.createElement('div');\r\n            div.setAttribute('class', 'dmx-autocomplete-item');\r\n            div.textContent = this.props.noresultslabel;\r\n            div.addEventListener('mousedown', (event) => {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                this.closeList();\r\n                this.dispatchEvent('noresults', null, { value: value });\r\n            });\r\n            this.list.appendChild(div);\r\n        }\r\n\r\n        this.showList();\r\n    },\r\n\r\n    onKeydown: function(event) {\r\n        if (event.keyCode == 40) {\r\n            event.preventDefault();\r\n            this.currentFocus++;\r\n            this.updateActive();\r\n            this.showList();\r\n        } else if (event.keyCode == 38) {\r\n            event.preventDefault();\r\n            this.currentFocus--;\r\n            this.updateActive();\r\n            this.showList();\r\n        } else if (event.keyCode == 27) {\r\n            event.preventDefault();\r\n            this.currentFocus = -1;\r\n            this.closeList();\r\n        } else if (event.keyCode == 13) {\r\n            // prevent the form from being submitted\r\n            event.preventDefault();\r\n\r\n            if (this.currentFocus > -1) {\r\n                const divs = this.list.getElementsByTagName('div');\r\n                if (divs) divs[this.currentFocus].dispatchEvent(new MouseEvent('mousedown'));\r\n            }\r\n        }\r\n    },\r\n\r\n    matches: function(item, value) {\r\n        if (item == null) return false;\r\n\r\n        if (!this.props.matchaccent) {\r\n            item = this.normalize(item);\r\n            value = this.normalize(value);\r\n        }\r\n\r\n        if (!this.props.matchcase) {\r\n            item = item.toLowerCase();\r\n            value = value.toLowerCase();\r\n        }\r\n\r\n        if (this.props.matchstart) {\r\n            item = item.substring(0, value.length);\r\n        }\r\n\r\n        return item.indexOf(value) != -1;\r\n    },\r\n\r\n    getItemHtml: function(item, value) {\r\n        var html = this.htmlEncode(item);\r\n        var matcher = new RegExp((this.props.matchstart ? '^' : '') + dmx.escapeRegExp(this.htmlEncode(value)), this.props.matchcase ? 'g' : 'gi');\r\n\r\n        html = html.replace(matcher, function(m) {\r\n            return '<b>' + m + '</b>';\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    htmlEncode: function(html) {\r\n        html = html.replace(/&/g, '&amp;');\r\n        html = html.replace(/\"/g, '&quot;');\r\n        html = html.replace(/</g, '&lt;');\r\n        html = html.replace(/>/g, '&gt;');\r\n        return html;\r\n    },\r\n\r\n    normalize: function(str) {\r\n        if (str.normalize) {\r\n            return str.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\r\n        }\r\n\r\n        var TAB_00C0 = 'AAAAAAACEEEEIIIIDNOOOOO*OUUUUYIsaaaaaaaceeeeiiii?nooooo/ouuuuy?yAaAaAaCcCcCcCcDdDdEeEeEeEeEeGgGgGgGgHhHhIiIiIiIiIiJjJjKkkLlLlLlLlLlNnNnNnnNnOoOoOoOoRrRrRrSsSsSsSsTtTtTtUuUuUuUuUuUuWwYyYZzZzZzF';\r\n        var result = str.split('');\r\n\r\n        for (var i = 0; i < result.length; i++) {\r\n            var c = str.charCodeAt(i);\r\n            if (c >= 0x00c0 && c <= 0x017f) {\r\n                result[i] = String.fromCharCode(TAB_00C0.charCodeAt(c - 0x00c0));\r\n            } else if (c > 127) {\r\n                result[i] = '?';\r\n            }\r\n        }\r\n\r\n        return result.join('');\r\n    },\r\n\r\n    updateActive: function() {\r\n        var divs = this.list.getElementsByTagName('div');\r\n\r\n        if (!divs) return;\r\n        if (this.currentFocus >= divs.length) this.currentFocus = 0;\r\n        if (this.currentFocus < 0) this.currentFocus = divs.length - 1;\r\n\r\n        for (var i = 0; i < divs.length; i++) {\r\n            divs[i].classList.remove('dmx-autocomplete-active');\r\n        }\r\n\r\n        divs[this.currentFocus].classList.add('dmx-autocomplete-active');\r\n    },\r\n\r\n    showList: function() {\r\n        if (!this.input.value) return;\r\n\r\n        this.list.style.left = this.input.offsetLeft + 'px';\r\n        this.list.style.top = (this.input.offsetTop + this.input.offsetHeight) + 'px';\r\n\r\n        if (this.$node.nextSibling) {\r\n            this.$node.parentNode.insertBefore(this.list, this.$node.nextSibling);\r\n        } else {\r\n            this.$node.parentNode.appendChild(this.list);\r\n        }\r\n    },\r\n\r\n    closeList: function() {\r\n        if (this.list.parentNode) {\r\n            this.list.parentNode.removeChild(this.list);\r\n        }\r\n    }\r\n\r\n});\r\n"]}